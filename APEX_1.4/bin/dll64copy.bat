REM the TODIR (destination folder) should NOT contain a trailing '\', this script will append it

SETLOCAL

SET NXDIR=%1
SET TODIR=%2\
SET FNDDIR=%3
SET NVTXDIR=%4
SET GLDIR=%5
SET WINSDKDIR=%6

echo Copy64
echo "NXDIR  = " %NXDIR%
echo "TARGET = " %TODIR%
echo "NVTXDIR = " %NVTXDIR%
echo FNDDIR = %FNDDIR%
echo GLDIR = %GLDIR%
echo WINSDKDIR = %WINSDKDIR%

IF "%2"=="" GOTO ARGUMENT_ERROR

CALL :UPDATE_TARGET %NXDIR% PhysXCore64.dll
CALL :UPDATE_TARGET %NXDIR% PhysXCore64DEBUG.dll
CALL :UPDATE_TARGET %NXDIR% PhysXCooking64.dll
CALL :UPDATE_TARGET %NXDIR% PhysXCooking64DEBUG.dll
CALL :UPDATE_TARGET %NXDIR% PhysXLoader64.dll
CALL :UPDATE_TARGET %NXDIR% PhysXLoader64DEBUG.dll

CALL :UPDATE_TARGET %NXDIR% PhysXDevice64.dll
CALL :UPDATE_TARGET %NXDIR% cudart*.dll

CALL :UPDATE_TARGET %NXDIR% PhysX3_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3CHECKED_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3DEBUG_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3PROFILE_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3Common_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3CommonCHECKED_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3CommonDEBUG_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3CommonPROFILE_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3CharacterKinematic_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3CharacterKinematicCHECKED_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3CharacterKinematicDEBUG_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3CharacterKinematicPROFILE_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3Cooking_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3CookingCHECKED_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3CookingDEBUG_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3CookingPROFILE_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3Gpu_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3GpuCHECKED_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3GpuDEBUG_x64.dll
CALL :UPDATE_TARGET %NXDIR% PhysX3GpuPROFILE_x64.dll
CALL :UPDATE_TARGET %NVTXDIR% nvToolsExt*.dll
REM CALL :UPDATE_TARGET %NXDIR% MemoryTracker.dll # Does that support 64

CALL :UPDATE_TARGET %FNDDIR% PxFoundation_x64.dll
CALL :UPDATE_TARGET %FNDDIR% PxFoundationCHECKED_x64.dll
CALL :UPDATE_TARGET %FNDDIR% PxFoundationPROFILE_x64.dll
CALL :UPDATE_TARGET %FNDDIR% PxFoundationDEBUG_x64.dll
CALL :UPDATE_TARGET %FNDDIR% PxPvdSDK_x64.dll
CALL :UPDATE_TARGET %FNDDIR% PxPvdSDKCHECKED_x64.dll
CALL :UPDATE_TARGET %FNDDIR% PxPvdSDKDEBUG_x64.dll
CALL :UPDATE_TARGET %FNDDIR% PxPvdSDKPROFILE_x64.dll
CALL :UPDATE_TARGET %GLDIR%\samples\bin\win64 AntTweakBar64.dll
CALL :UPDATE_TARGET %WINSDKDIR%\bin\x64 d3dcompiler_47.dll

set USER_PROFILER="..\..\..\shared\general\PxUserProfilerCallback\bin\win64"
REM CALL :UPDATE_TARGET  %USER_PROFILER% DejaDLL.Win64.dll
IF /I NOT "%5"=="NOPROFILER" CALL :UPDATE_TARGET  %USER_PROFILER% PxUserProfilerCallback_x64.dll
IF /I NOT "%5"=="NOPROFILER" CALL :UPDATE_TARGET  %USER_PROFILER% telemetry64.dll
IF /I NOT "%5"=="NOPROFILER" CALL :UPDATE_TARGET  %USER_PROFILER% nvToolsExt64_1.dll

ENDLOCAL
GOTO END


REM ********************************************
REM NO CALLS TO :UPDATE_TARGET below this line!!
REM ********************************************

:UPDATE_TARGET
IF NOT EXIST %1\%2 (
	echo File doesn't exist %1\%2
) ELSE (
	REM echo updating %2
  REM echo XCOPY "%1\%2" "%TODIR%"
	XCOPY "%1\%2" "%TODIR%" /D /Y
)
GOTO END

:ARGUMENT_ERROR
ECHO ERROR: too few arguments to dll64copy.bat (need PhysXBinDir ApexBinDir)

:END
